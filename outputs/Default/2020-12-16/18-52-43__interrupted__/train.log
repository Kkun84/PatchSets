[2020-12-16 18:52:44,088][__main__][INFO] - 
project_name: PatchSets
experiment_name: Default
debug: false
hparams:
  patch_size: 15
  hidden_n: 1024
  feature_n: 256
  output_n: ${data.class_num}
  pool_mode: sum
  patch_num_min: 1
  patch_num_max: 256
  seed: 0
  batch_size: 256
  num_workers: 6
  max_epochs: 100000
  min_epochs: 10
  patience: 100
  optimizer: Adam
  lr: 0
  data_split_num: ${data.datamodule.data_split_num}
  data_use_num: ${data.datamodule.data_use_num}
data:
  datamodule:
    _target_: src.datamodule.AdobeFontDataModule
    path: /dataset/AdobeFontCharImages
    upper: true
    lower: false
    data_split_num: 5
    data_use_num: 0
    seed: ${hparams.seed}
    batch_size: ${hparams.batch_size}
    num_workers: ${hparams.num_workers}
  name: AdobeFontCharImages
  class_num: 26
trainer:
  max_epochs: ${hparams.max_epochs}
  min_epochs: ${hparams.min_epochs}
  auto_scale_batch_size: false
  gpus: 1
  auto_select_gpus: true
  num_nodes: 1
  accelerator: null
  benchmark: true
  deterministic: true
  gradient_clip_val: 0
  track_grad_norm: -1
  overfit_batches: 0.0
  precision: 32
  fast_dev_run: ${debug}
  profiler: simple
  weights_summary: full
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
model_checkpoint:
  monitor: valid_loss
  verbose: false
  save_last: null
  save_top_k: null
  save_weights_only: false
  mode: min
  prefix: ''
  dirpath: ./checkpoints
  filename: null
early_stopping:
  monitor: valid_loss
  min_delta: 0
  patience: ${hparams.patience}
  verbose: false
  mode: min
callbacks: []
loggers:
- _target_: pytorch_lightning.loggers.TensorBoardLogger
  save_dir: .
  name: ''
  version: lightning_logs
- _target_: pytorch_lightning.loggers.MLFlowLogger
  experiment_name: ${experiment_name}
  tracking_uri: file:/workspace/mlruns
  tags: null
  save_dir: null
- _target_: pytorch_lightning.loggers.NeptuneLogger
  api_key: ${env:NEPTUNE_API_TOKEN}
  project_name: kanda/${project_name}
  experiment_name: ${experiment_name}
  tags: null
  upload_source_files:
  - /workspace/src
  - /workspace/config

[2020-12-16 18:52:58,096][lightning][INFO] - NeptuneLogger will work in online mode
[2020-12-16 18:52:59,314][lightning][INFO] - GPU available: True, used: True
[2020-12-16 18:52:59,314][lightning][INFO] - TPU available: False, using: 0 TPU cores
[2020-12-16 18:52:59,314][lightning][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[2020-12-16 18:53:04,768][lightning][INFO] - 
  | Name             | Type     | Params
----------------------------------------------
0 | accuracy         | Accuracy | 0     
1 | flatten          | Flatten  | 0     
2 | encoder_linear_1 | Linear   | 231 K 
3 | encoder_linear_2 | Linear   | 262 K 
4 | decoder_linear_1 | Linear   | 263 K 
5 | decoder_linear_2 | Linear   | 26 K  
[2020-12-16 18:53:17,527][lightning][INFO] - 

Profiler Report

Action              	|  Mean duration (s)	|  Total time (s) 
-----------------------------------------------------------------
on_fit_start        	|  1.603e-05      	|  1.603e-05      
on_validation_start 	|  2.0363e-05     	|  4.0726e-05     
on_validation_epoch_start	|  1.3991e-05     	|  2.7982e-05     
on_validation_batch_start	|  1.4564e-05     	|  0.00032041     
validation_step_end 	|  1.4096e-05     	|  0.00031011     
on_validation_batch_end	|  1.0202e-05     	|  0.00022445     
on_validation_epoch_end	|  2.5423e-05     	|  5.0845e-05     
on_validation_end   	|  2.5918e-05     	|  5.1836e-05     
on_train_start      	|  1.9917e-05     	|  1.9917e-05     
on_epoch_start      	|  1.5734e-05     	|  3.1468e-05     
on_train_epoch_start	|  1.2895e-05     	|  2.5789e-05     
get_train_batch     	|  0.0061583      	|  0.57272        
on_batch_start      	|  3.5949e-05     	|  0.0033433      
on_train_batch_start	|  1.0992e-05     	|  0.0010222      
training_step_end   	|  1.3198e-05     	|  0.0012274      
model_forward       	|  0.069466       	|  6.4603         
model_backward      	|  0.034724       	|  3.2293         
on_after_backward   	|  1.0619e-05     	|  0.00098759     
optimizer_step      	|  0.10559        	|  9.8198         
on_batch_end        	|  1.6431e-05     	|  0.0015281      
on_train_batch_end  	|  0.00027891     	|  0.025939       
on_epoch_end        	|  1.5023e-05     	|  3.0046e-05     
on_train_epoch_end  	|  1.322e-05      	|  2.6439e-05     
on_train_end        	|  2.7552e-05     	|  2.7552e-05     

[2020-12-16 18:53:17,544][lightning][INFO] - LR finder stopped early due to diverging loss.
[2020-12-16 18:53:17,547][lightning][INFO] - Learning rate set to 6.918309709189363e-05
[2020-12-16 18:53:30,409][__main__][INFO] - Rename directory name. "/workspace/outputs/Default/2020-12-16/18-52-43" -> "/workspace/outputs/Default/2020-12-16/18-52-43__interrupted"
