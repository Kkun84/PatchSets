[2020-12-16 16:37:11,433][__main__][INFO] - 
project_name: PatchSets
experiment_name: Default
debug: false
hparams:
  patch_size: 15
  hidden_n: 64
  feature_n: 2
  output_n: ${data.class_num}
  pool_mode: sum
  patch_num_min: 1
  patch_num_max: 256
  seed: 0
  batch_size: 256
  num_workers: 6
  max_epochs: 10000
  min_epochs: 10
  patience: 100
  optimizer: Adam
  lr: 0
  data_split_num: ${data.datamodule.data_split_num}
  data_use_num: ${data.datamodule.data_use_num}
data:
  datamodule:
    _target_: src.datamodule.AdobeFontDataModule
    path: /dataset/AdobeFontCharImages
    upper: true
    lower: false
    data_split_num: 5
    data_use_num: 0
    seed: ${hparams.seed}
    batch_size: ${hparams.batch_size}
    num_workers: ${hparams.num_workers}
  name: AdobeFontCharImages
  class_num: 26
trainer:
  max_epochs: ${hparams.max_epochs}
  min_epochs: ${hparams.min_epochs}
  auto_scale_batch_size: false
  gpus: 1
  auto_select_gpus: true
  num_nodes: 1
  accelerator: null
  benchmark: true
  deterministic: true
  gradient_clip_val: 0
  track_grad_norm: -1
  overfit_batches: 0.0
  precision: 32
  fast_dev_run: ${debug}
  profiler: simple
  weights_summary: full
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
model_checkpoint:
  monitor: valid_loss
  verbose: false
  save_last: null
  save_top_k: null
  save_weights_only: false
  mode: min
  prefix: ''
  dirpath: ./checkpoints
  filename: null
early_stopping:
  monitor: valid_loss
  min_delta: 0
  patience: ${hparams.patience}
  verbose: false
  mode: min
callbacks: []
loggers:
- _target_: pytorch_lightning.loggers.TensorBoardLogger
  save_dir: .
  name: ''
  version: lightning_logs
- _target_: pytorch_lightning.loggers.MLFlowLogger
  experiment_name: ${experiment_name}
  tracking_uri: file:/workspace/mlruns
  tags: null
  save_dir: null
- _target_: pytorch_lightning.loggers.NeptuneLogger
  api_key: ${env:NEPTUNE_API_TOKEN}
  project_name: kanda/${project_name}
  experiment_name: ${experiment_name}
  tags: null
  upload_source_files:
  - /workspace/src
  - /workspace/config

[2020-12-16 16:37:20,337][lightning][INFO] - NeptuneLogger will work in online mode
[2020-12-16 16:37:21,612][lightning][INFO] - GPU available: True, used: True
[2020-12-16 16:37:21,613][lightning][INFO] - TPU available: False, using: 0 TPU cores
[2020-12-16 16:37:21,613][lightning][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[2020-12-16 16:37:27,288][lightning][INFO] - 
  | Name             | Type     | Params
----------------------------------------------
0 | accuracy         | Accuracy | 0     
1 | flatten          | Flatten  | 0     
2 | encoder_linear_1 | Linear   | 14 K  
3 | encoder_linear_2 | Linear   | 130   
4 | decoder_linear_1 | Linear   | 192   
5 | decoder_linear_2 | Linear   | 1 K   
[2020-12-16 16:37:40,579][lightning][INFO] - 

Profiler Report

Action              	|  Mean duration (s)	|  Total time (s) 
-----------------------------------------------------------------
on_fit_start        	|  1.5038e-05     	|  1.5038e-05     
on_validation_start 	|  1.9311e-05     	|  3.8621e-05     
on_validation_epoch_start	|  1.3336e-05     	|  2.6671e-05     
on_validation_batch_start	|  1.5413e-05     	|  0.00033909     
validation_step_end 	|  1.3379e-05     	|  0.00029433     
on_validation_batch_end	|  9.377e-06      	|  0.00020629     
on_validation_epoch_end	|  2.167e-05      	|  4.3341e-05     
on_validation_end   	|  2.0793e-05     	|  4.1587e-05     
on_train_start      	|  2.8884e-05     	|  2.8884e-05     
on_epoch_start      	|  1.4917e-05     	|  2.9835e-05     
on_train_epoch_start	|  1.1696e-05     	|  2.3393e-05     
get_train_batch     	|  0.0062703      	|  0.62076        
on_batch_start      	|  3.8346e-05     	|  0.0037962      
on_train_batch_start	|  1.2049e-05     	|  0.0011929      
training_step_end   	|  1.2435e-05     	|  0.0012311      
model_forward       	|  0.069459       	|  6.8765         
model_backward      	|  0.033575       	|  3.3239         
on_after_backward   	|  1.3251e-05     	|  0.0013118      
optimizer_step      	|  0.10439        	|  10.334         
on_batch_end        	|  1.8894e-05     	|  0.0018705      
on_train_batch_end  	|  0.00028687     	|  0.0284         
on_epoch_end        	|  1.1466e-05     	|  2.2932e-05     
on_train_epoch_end  	|  1.2383e-05     	|  2.4766e-05     
on_train_end        	|  2.7762e-05     	|  2.7762e-05     

[2020-12-16 16:37:40,583][lightning][INFO] - LR finder stopped early due to diverging loss.
[2020-12-16 16:37:40,585][lightning][INFO] - Learning rate set to 0.0001
[2020-12-16 16:37:51,690][lightning][INFO] - 
  | Name             | Type     | Params
----------------------------------------------
0 | accuracy         | Accuracy | 0     
1 | flatten          | Flatten  | 0     
2 | encoder_linear_1 | Linear   | 14 K  
3 | encoder_linear_2 | Linear   | 130   
4 | decoder_linear_1 | Linear   | 192   
5 | decoder_linear_2 | Linear   | 1 K   
[2020-12-16 16:58:03,693][neptune.internal.channels.channels_values_sender][ERROR] - Failed to send channel value.
Traceback (most recent call last):
  File "/opt/conda/lib/python3.7/site-packages/neptune/internal/channels/channels_values_sender.py", line 156, in _send_values
    self._experiment._send_channels_values(channels_with_values)
  File "/opt/conda/lib/python3.7/site-packages/neptune/experiments.py", line 1138, in _send_channels_values
    self._backend.send_channels_values(self, channels_with_values)
  File "/opt/conda/lib/python3.7/site-packages/neptune/utils.py", line 210, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/neptune/internal/backends/hosted_neptune_backend.py", line 572, in send_channels_values
    raise ChannelsValuesSendBatchError(experiment.id, batch_errors)
neptune.api_exceptions.ChannelsValuesSendBatchError: Received batch errors sending channels' values to experiment PATCH-122. Cause: Error(code=400, message='X-coordinates must be strictly increasing for channel: c78778bd-47cb-44fb-9880-a478cf1d4dc9. Invalid point: InputChannelValue(timestamp=2020-12-16T07:43:58.491Z, x=2849.0, numericValue=36.0, textValue=null, i', type=None) (metricId: 'c78778bd-47cb-44fb-9880-a478cf1d4dc9', x: 2849.0) Skipping 1 values.
[2020-12-16 19:21:46,234][__main__][INFO] - All done.
